---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
library(magrittr)
library(devtools)
```

## Package Review

*Please check off boxes as applicable, and elaborate in comments below.  Your review is not limited to these topics, as described in the reviewer guide*

- **Briefly describe any working relationship you have (had) with the package authors.**
- [x] As the reviewer I confirm that there are no [conflicts of interest](https://devguide.ropensci.org/policies.html#coi) for me to review this work (if you are unsure whether you are in conflict, please speak to your editor _before_ starting your review).

#### Documentation

The package includes all the following forms of documentation:

- [x] **A statement of need:** clearly stating problems the software is designed to solve and its target audience in README
- [x] **Installation instructions:** for the development version of package and any non-standard dependencies in README
- [x] **Vignette(s):** demonstrating major functionality that runs successfully locally
- [ ] **Function Documentation:** for all exported functions
- [ ] **Examples:** (that run successfully locally) for all exported functions
- [ ] **Community guidelines:** including contribution guidelines in the README or CONTRIBUTING, and DESCRIPTION with `URL`, `BugReports` and `Maintainer` (which may be autogenerated via `Authors@R`).

#### Functionality

- [x] **Installation:** Installation succeeds as documented.
- [ ] **Functionality:** Any functional claims of the software been confirmed.
- [ ] **Performance:** Any performance claims of the software been confirmed.
- [ ] **Automated tests:** Unit tests cover essential functions of the package and a reasonable range of inputs and conditions. All tests pass on the local machine.
- [ ] **Packaging guidelines**: The package conforms to the rOpenSci packaging guidelines.

Estimated hours spent reviewing:

- [ ] Should the author(s) deem it appropriate, I agree to be acknowledged as a package reviewer ("rev" role) in the package DESCRIPTION file.

---

### Review Comments


- README: In the README, the authors use an abbreviation (FAIR). It might be good to clarify what is about (Findability, Accessibility, Interoperability, and Reusability). Also, for readers that are not introduced to  the concept of FAIR, what do you think about linking a texto to clarify it? Such as  <https://www.nature.com/articles/sdata201618> or <https://www.go-fair.org/fair-principles/>

## Vignette

- In the [vignette](https://frictionlessdata.github.io/frictionless-r/articles/frictionless.html),  the pipe from `magrittr` is used but it was not loaded. So if someone is trying to follow the code in the vignette, there is an `could not find function "%>%"` error.

- Just for the record: When executing `library(frictionless)` there is a message saying that `The following object is masked from ‘package:usethis’: create_package`.

- Adding the descriptions to the schema does not seem trivial. There is an example with `purrr` package. But the example might be not simple to understand if someone is not used to the `purrr` package. 

I`m talking about this piece of code:

```r
iris_schema <- create_schema(iris)

# Remove description for first field
iris_schema$fields[[1]]$description <- NULL

# Set descriptions for all fields
descriptions <- c(
  "Sepal length in cm.",
  "Sepal width in cm.",
  "Pedal length in cm.",
  "Pedal width in cm.",
  "Iris species."
)
iris_schema$fields <- purrr::imap(
  iris_schema$fields,
  ~ c(.x, description = descriptions[.y])
)
```
Do the authors think that it is possible to create a function to add descriptions to the schema, in a way that is used in a similar way as  the other functions of the package? Example of the idea:

```r
iris_schema <- create_schema(iris) |>
  add_description(
    c(
      "Sepal length in cm.",
      "Sepal width in cm.",
      "Pedal length in cm.",
      "Pedal width in cm.",
      "Iris species."
    )
  )
```

- The vignette says that in order to validate the Data Package, the users need to use Python. Is there any plans to implement that funcionality in R aswell?

> Validate your Data Package before depositing. You can do this in Python with the Frictionless Framework using frictionless validate datapackage.json.

- In the vignette, there is some instructions to zip the csv to reduce size of the files:

> Zip the individual csv files (and update their paths in datapackage.json) to reduce size, not the entire Data Package. That way, users still have direct access to the datapackage.json file. See this example.

Do the authors think that is a good idea to add an argument on `write_package()` to write the zipped csvs, to facilitate this step? Something like:

```r 
write_package(my_package, "my_directory", zip_files = TRUE)
```

[Since the function uses `readr::write_csv()`](https://github.com/frictionlessdata/frictionless-r/blob/a446512da1ff00384f06064d3cdfab1d3ce2d29f/R/write_resource.R#L18), if `zip_files = TRUE` it could add `.gz` at the end of the filepath and readr would zip it on the fly. 

Example:

```{r}
readr::write_csv(mtcars, "mtcars.csv")
file.size("mtcars.csv")
#> [1] 1281

readr::write_csv(mtcars, "mtcars_zipped.csv.gz")
file.size("mtcars_zipped.csv.gz")
#> [1] 558
```
até agora: 1h10


